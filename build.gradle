plugins {
  id 'java'
  id 'com.github.johnrengelman.shadow' version '8.1.1'
}

group = 'com.dulion.akka'
version = '1.0-SNAPSHOT'

repositories {
  mavenCentral()
  maven {
    url "https://repo.akka.io/maven"
  }
}

def versions = [
    ScalaBinary: "2.13"
]

dependencies {
  compileOnly 'org.projectlombok:lombok:1.18.34'
  annotationProcessor 'org.projectlombok:lombok:1.18.34'

  implementation platform("com.typesafe.akka:akka-bom_${versions.ScalaBinary}:2.9.4")
  implementation "com.typesafe.akka:akka-actor-typed_${versions.ScalaBinary}"
  implementation "com.fasterxml.jackson.core:jackson-databind:2.17.1"
  implementation "com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:2.17.1"
  runtimeOnly "org.apache.logging.log4j:log4j-slf4j-impl:2.23.1"

  testImplementation "com.typesafe.akka:akka-actor-testkit-typed_${versions.ScalaBinary}"
  testImplementation "junit:junit:4.13.2"
}

test {
  useJUnitPlatform()
}

tasks.named("build") {
  dependsOn(tasks.named("shadowJar"))
}

shadowJar {
  append 'reference.conf'
  append 'version.conf'
  with jar
  manifest {
    attributes "Main-Class": "com.dulion.akka.Main"
  }
}